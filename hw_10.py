import requests

"""
Описание уязвимости

CVE-2022-1388 — уязвимость обхода аутентификации в интерфейсе управления сетевыми 
устройствами (BIG-IP iControl REST).
Позволяла удалённому атакующему отправлять специально сформированные HTTP-запросы и 
выполнять команды без прохождения аутентификации.

    Суть проблемы:
Некорректная проверка заголовков HTTP позволяла системе считать запрос доверенным.

    Потенциальные последствия:
Выполнение команд на устройстве
Получение доступа к конфигурации
Полный компромисс системы

Важно
Ниже только имитация:
Используется условный URL
Нет вредоносных payload
Только демонстрация логики PoC
"""

# Условный адрес уязвимого сервиса
url = "http://test-vulnerable.local/api/mock-endpoint"

# Имитация подозрительных заголовков
headers = {
    "User-Agent": "PoC-Tester",
    "X-Debug-Auth-Bypass": "true",   # Условный «подозрительный» заголовок
    "Connection": "close"
}

print("[*] Отправка тестового запроса к потенциально уязвимой точке...")

try:
    response = requests.get(url, headers=headers, timeout=5)

    print(f"[*] Код ответа сервера: {response.status_code}")

    if response.status_code == 200:
        print("[+] Сервер ответил успешно.")
        print("[!] Если это была реальная уязвимость — возможен обход защиты.")
        print("[*] Фрагмент ответа:")
        print(response.text[:150])
    else:
        print("[-] Сервер не показал признаков уязвимости.")

except requests.exceptions.RequestException as e:
    print("[-] Ошибка соединения (для тестового PoC):")
    print(e)
